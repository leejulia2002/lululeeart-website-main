// Gallery Array
const galleries = {
  thesis: [
    { id: "honors3", src: "../assets/images/thesis/honors3.png" },
    { id: "honors4", src: "../assets/images/thesis/honors4.png" },
    { id: "honors5", src: "../assets/images/thesis/honors5.png" },
    { id: "honors6", src: "../assets/images/thesis/honors6.png" },
    { id: "honors7", src: "../assets/images/thesis/honors7.png" },
    { id: "honors8", src: "../assets/images/thesis/honors8.png" },
    { id: "honors9", src: "../assets/images/thesis/honors9.png" },
    { id: "honors10", src: "../assets/images/thesis/honors10.png" },
    { id: "honors11", src: "../assets/images/thesis/honors11.png" },
    { id: "honors12", src: "../assets/images/thesis/honors12.png" },
    { id: "honors13", src: "../assets/images/thesis/honors13.png" },
    { id: "honors14", src: "../assets/images/thesis/honors14.png" },
    { id: "honors15", src: "../assets/images/thesis/honors15.png" },
    { id: "honors16", src: "../assets/images/thesis/honors16.png" },
    { id: "honors17", src: "../assets/images/thesis/honors17.png" },
    { id: "honors18", src: "../assets/images/thesis/honors18.png" },
    { id: "honors19", src: "../assets/images/thesis/honors19.png" },
    { id: "honors20", src: "../assets/images/thesis/honors20.png" },
    { id: "honors21", src: "../assets/images/thesis/honors21.png" },
    { id: "honors22", src: "../assets/images/thesis/honors22.png" },
    { id: "honors23", src: "../assets/images/thesis/honors23.png" },
    { id: "honors24", src: "../assets/images/thesis/honors24.png" },
    { id: "honors25", src: "../assets/images/thesis/honors25.png" },
    { id: "honors26", src: "../assets/images/thesis/honors26.png" },
    { id: "honors27", src: "../assets/images/thesis/honors27.png" },
    { id: "honors28", src: "../assets/images/thesis/honors28.png" },
    { id: "honors29", src: "../assets/images/thesis/honors29.png" },
    { id: "honors30", src: "../assets/images/thesis/honors30.png" },
    { id: "honors31", src: "../assets/images/thesis/honors31.png" },
    { id: "honors32", src: "../assets/images/thesis/honors32.png" },
    { id: "honors33", src: "../assets/images/thesis/honors33.png" },
    { id: "honors34", src: "../assets/images/thesis/honors34.png" },
    { id: "honors35", src: "../assets/images/thesis/honors35.png" },
    { id: "honors36", src: "../assets/images/thesis/honors36.png" },
    { id: "honors37", src: "../assets/images/thesis/honors37.png" },
    { id: "honors38", src: "../assets/images/thesis/honors38.png" },
    { id: "honors39", src: "../assets/images/thesis/honors39.png" },
    { id: "honors40", src: "../assets/images/thesis/honors40.png" },
    { id: "honors41", src: "../assets/images/thesis/honors41.png" },
    { id: "honors42", src: "../assets/images/thesis/honors42.png" },
    { id: "honors43", src: "../assets/images/thesis/honors43.png" },
    { id: "honors44", src: "../assets/images/thesis/honors44.png" },
    { id: "honors45", src: "../assets/images/thesis/honors45.png" },
    { id: "honors46", src: "../assets/images/thesis/honors46.png" },
    { id: "honors47", src: "../assets/images/thesis/honors47.png" },
    { id: "honors48", src: "../assets/images/thesis/honors48.png" },
    { id: "honors49", src: "../assets/images/thesis/honors49.png" },
    { id: "honors50", src: "../assets/images/thesis/honors50.png" },
    { id: "honors51", src: "../assets/images/thesis/honors51.png" },
    { id: "honors52", src: "../assets/images/thesis/honors52.png" },
    { id: "honors53", src: "../assets/images/thesis/honors53.png" },
  ],
  zine: [
    // zine2 links to image with less whitespace
    { id: "zine2", src: "../assets/images/zine/zine-covers-large.png" },
    { id: "zine3", src: "../assets/images/zine/zine4.png" },
    { id: "zine4", src: "../assets/images/zine/zine5.png" },
    { id: "zine5", src: "../assets/images/zine/zine6.png" },
    { id: "zine6", src: "../assets/images/zine/zine7.png" },
    { id: "zine7", src: "../assets/images/zine/zine8.png" },
  ],
  "childrens-book": [
    { id: "coco2", src: "../assets/images/coco/coco2.png" },
    { id: "coco3", src: "../assets/images/coco/coco3.png" },
    { id: "coco4", src: "../assets/images/coco/coco4.png" },
    { id: "coco5", src: "../assets/images/coco/coco5.png" },
    { id: "coco2", src: "../assets/images/coco/coco6.png" },
  ],
  prints: [
    { id: "print1", src: "../assets/images/books&prints/books6.png" },
    { id: "print2", src: "../assets/images/books&prints/books7.png" },
    { id: "print3", src: "../assets/images/books&prints/books8.png" },
    { id: "print4", src: "../assets/images/books&prints/books9.png" },
  ],
  illustration: [
    { id: "ill1", src: "../assets/images/illustration/ill1.png"},
    { id: "ill2", src: "../assets/images/illustration/ill2.png"},
    { id: "ill3", src: "../assets/images/illustration/ill3.png"},
    { id: "ill4", src: "../assets/images/illustration/ill4.png"},
    { id: "ill5", src: "../assets/images/illustration/ill5.png"},
    { id: "ill6", src: "../assets/images/illustration/ill6.png"},
    { id: "ill7", src: "../assets/images/illustration/ill7.png"},
  ],
  work: [
    { id: "work1", src: "../assets/images/work/work1.png"},
    { id: "work2", src: "../assets/images/work/work2.png"},
    { id: "work10", src: "../assets/images/work/work10.png"},
    { id: "work11", src: "../assets/images/work/work11.png"},
    { id: "work3", src: "../assets/images/work/work3.png"},
    { id: "work4", src: "../assets/images/work/work4.png"},
    { id: "work5", src: "../assets/images/work/work5.png"},
    { id: "work6", src: "../assets/images/work/work6.png"},
    { id: "work7", src: "../assets/images/work/work7.png"},
    { id: "work8", src: "../assets/images/work/work8.png"},
    { id: "work9", src: "../assets/images/work/work9.png"},
  ]

};

// Determine Current Gallery
const params = new URLSearchParams(window.location.search);
const galleryName = params.get("gallery");
const currentGallery = galleries[galleryName] || [];
const currentId = params.get("image");
let currentIndex = currentGallery.findIndex(item => item.id === currentId);

// Get references to HTML elements
const imageElement = document.getElementById("artwork-image");
const leftArrow = document.getElementById("left-arrow");
const rightArrow = document.getElementById("right-arrow");

// Populate Image and Update Arrow Visibility
function populateImage() {
  if (currentIndex === -1 || currentIndex >= currentGallery.length) {
    console.error("Image not found or index out of bounds!");
    return;
  }

  // Update image source
  const currentImage = currentGallery[currentIndex];
  imageElement.src = currentImage.src;
  imageElement.alt = `Artwork ${currentImage.id}`;

  // Update arrow visibility
  updateArrowVisibility();
}

// Update Arrow Visibility
function updateArrowVisibility() {
  
  if (currentIndex === 0) {
    leftArrow.classList.add("hidden");
  } else {
    leftArrow.classList.remove("hidden");
  }

  if (currentIndex === currentGallery.length - 1) {
    rightArrow.classList.add("hidden");
  } else {
    rightArrow.classList.remove("hidden");
  }
  
  
  // leftArrow.style.display = currentIndex === 0 ? "none" : "block"; // Hide left arrow on the first image
  // rightArrow.style.display = currentIndex === gallery.length - 1 ? "none" : "block"; // Hide right arrow on the last image
}

// Navigate Left or Right
function navigateImage(direction) {
  if (direction === "left" && currentIndex > 0) {
    currentIndex--;
  } else if (direction === "right" && currentIndex < currentGallery.length - 1) {
    currentIndex++;
  }

  // Ensure currentIndex stays in valid bounds
  currentIndex = Math.max(0, Math.min(currentIndex, currentGallery.length - 1));

  // Update the URL and display the new image
  const newUrl = `?gallery=${galleryName}&image=${currentGallery[currentIndex].id}`;
  window.history.replaceState(null, "", newUrl);
  populateImage();
}

// Navigate to fullscreen and store scroll position
function openFullscreen(galleryName, imageId) {
  // Store current scroll position
  const scrollPosition = window.scrollY;
  sessionStorage.setItem("scrollPosition", scrollPosition);

  // Navigate to fullscreen page
  const fullscreenUrl = `artwork.html?gallery=${galleryName}&image=${imageId}`;
  window.location.href = fullscreenUrl;
}


// Close Fullscreen and Go Back to Page your opened image was on
function closeFullscreen() {
  let returnPage;
  
  switch (galleryName) {
    case "prints":
    case "zine":
    case "childrens-book":
    case "thesis":
      returnPage = "../pages/books-prints.html";
      break;
    case "work":
      returnPage = "../pages/index.html";
      break;
    case "illustration":
      returnPage = "../pages/illustration.html";
      break;
    default:
      returnPage = `../pages/${galleryName}.html`; // Default case for other galleries
  }

  window.location.href = returnPage;
}


// Event Listeners
// Close fullscreen on outside click
document.addEventListener("click", (event) => {
  if (!imageElement.contains(event.target) && !leftArrow.contains(event.target) && !rightArrow.contains(event.target)) {
    closeFullscreen();
  }
});

// Navigate with keyboard arrows
document.addEventListener("keydown", (event) => {
  if (event.key === "ArrowLeft" && currentIndex > 0) {
    navigateImage("left");
  } else if (event.key === "ArrowRight" && currentIndex < currentGallery.length - 1) {
    navigateImage("right");
  } else if (event.key === "Escape") {
    closeFullscreen();
  }
});

// Ensure valid currentIndex
if (currentIndex === -1) {
  currentIndex = 0; // Default to the first image
} else if (currentIndex >= currentGallery.length) {
  currentIndex = currentGallery.length - 1; // Default to the last image
}


// Add click listeners to arrows
leftArrow.addEventListener("click", () => navigateImage("left"));
rightArrow.addEventListener("click", () => navigateImage("right"));

// Highlight the active page in the sidebar
function setActivePage() {
  const workLink = document.getElementById("work-link");
  const illustrationLink = document.getElementById("illustration-link");
  const booksPrintsLink = document.getElementById("books-prints-link");

  // Remove existing active classes
  [workLink, illustrationLink, booksPrintsLink].forEach(link => link.classList.remove("active"));

  // Set active based on gallery name
  switch (galleryName) {
    case "work":
      workLink.classList.add("active");
      break;
    case "illustration":
      illustrationLink.classList.add("active");
      break;
    case "prints":
      booksPrintsLink.classList.add("active");
      break;
    default:
      break; // No active link for other galleries
  }
}

// Restore scroll position if available
document.addEventListener("DOMContentLoaded", () => {
  const storedScrollPosition = sessionStorage.getItem("scrollPosition");
  if (storedScrollPosition !== null) {
    window.scrollTo(0, parseInt(storedScrollPosition, 10));
    sessionStorage.removeItem("scrollPosition"); // Clear it after restoring
  }
});


// Call the function to set the active page
setActivePage();


// Initialize by populating the first image
populateImage();